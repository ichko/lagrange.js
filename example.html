<html>
    <head>
        <meta charset="utf-8">
        <title>Example</title>

        <style>*{padding: 0;margin: 0}</style>
    </head>
    <body>
        <canvas id="canvas"></canvas>

        <script src="lagrange.js"></script>
        <script src="plotter.js"></script>
        <script src="io.js"></script>
        
        <script>

            let [ canvas, ctx, width, height ] = ((canvasId) => {
                let canvas = document.getElementById(canvasId);
                [ canvas.width, canvas.height ] = [ innerWidth, innerHeight ];

                let ctx = canvas.getContext('2d');
                ctx.translate(canvas.width / 2, canvas.height / 2);

                return [ canvas, ctx, canvas.width, canvas.height ];
            })('canvas');

                
            let plotter = new Plotter(ctx),
                io = new IO(),
                lagrange = new Lagrange(plotter.points);

            io
                .onKey('+', () => plotter.config.scale *= 1.1)
                .onKey('-', () => plotter.config.scale /= 1.1)
                .onMouse('scroll', (direction) => plotter.config.scale *= 1.2 ** direction)
                .onMouse('click', (point) => {
                    point = {
                        x: point.x - width / 2,
                        y: -point.y + height / 2
                    };
                    plotter.addScaledPoint(point);
                    lagrange.build();
                });
                
            
            plotter.addFunctionBuilders([lagrange.getBuilder(), () => Math.sin]);

            (function draw() {
                io.invokeHandlers();
                plotter
                    .clear(width, height)
                    .show();

                requestAnimationFrame(draw);
            })();

        </script>
    </body>
</html>